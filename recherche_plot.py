#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import sys
import re
import matplotlib.pyplot as plt
import Intensite

#----------Récupération des colonnes----------#

# le numéro des colonnes est donné de manière "naturelle",
# on soustrait donc 1 au nombre donné pour avoir l'index.
parameterColumn = int(sys.argv[5]) - 1
variableColumn = int(sys.argv[6]) - 1

#----------Récupération des paramètres----------#

# On récupère le début et la fin de l'intervalle à grapher donné par l'utilisateur.
# Si startInterval < ExtractedData[colonne1][0] ou si l'utilisateur a demandé une valeur par défaut,
# on pose endInterval = ExtractedData[0][0]
# Même chose pour endInterval.
intervalStart, intervalEnd = sys.argv[4].split("_")
if re.search("(d[ée]faul?t|none)", intervalStart.lower()):
    intervalStart = Intensite.Data[parameterColumn][0]
else:
    intervalStart = Intensite.traitementValeur(intervalStart)
if re.search("(d[ée]faul?t|none)", intervalEnd.lower()):
    intervalEnd = Intensite.Data[parameterColumn][-1]
else:
    intervalEnd = Intensite.traitementValeur(intervalEnd)

# Dans le cas où l'utilisateur ait mis une fin plus petite que le début par erreur,
# on inverse les valeurs.
if intervalStart >= intervalEnd:
    intervalStart, intervalEnd = intervalEnd, intervalStart

#----------Génération des listes pour le plot----------#

ParameterList = [] #Servira à stocker les données qui iront sur l'axe des x
VariableList = [] #Servira à stocker les données qui iront sur l'axe des y
for value in Intensite.Data[parameterColumn]:
    # On utilise une technique similaire à celle utilisée pour le dictionnaire dans intensité.py
    if intervalStart <= value <= intervalEnd:
        index = Intensite.Data[parameterColumn].index(value)
        ParameterList = ParameterList + [Intensite.Data[parameterColumn][index]]
        VariableList = VariableList + [Intensite.Data[variableColumn][index]]

#----------Génération du plot----------#

# cette partie permet de grapher la liste des Y en fonction de celle des X
# plt.style.use()
plt.plot(ParameterList, VariableList, color='lightseagreen')
plt.title(f"Graphique allant de {ParameterList[0]:.2f} à {ParameterList[-1]:.2f}")
plt.xlabel("Axe de la colonne1")
plt.ylabel("Axe de la colonne2")
plt.show()